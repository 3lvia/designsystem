@use '../../variables/colors';
@use '../../variables/typography';
@use '../../utilities/outline';
@use '../../utilities/helpers';

$form-radiobutton-mark-size: 24px;
$form-radiobutton-compact-mark-size: 16px;
$form-radiobutton-mark-border-radius: 14px;
$form-radiobutton-mark-border: 1px solid colors.color('elvia-off');

.e-radio {
  // Variable containing '&' to jump to current parent inside a child class.
  $this: &;
  display: flex;
  align-items: center;
  box-sizing: border-box;
  width: fit-content;
  position: relative;
  cursor: pointer;

  @include typography.typography('text-option');
  color: colors.color('font-color');
  line-height: 24px;
  text-align: left;

  &:not(:last-child) {
    margin-bottom: 8px;
  }

  &.e-radio--compact,
  &.e-radio--sm {
    @include typography.typography('text-sm');
    color: colors.color('font-color');

    &:not(:last-child) {
      margin-bottom: 0px;
    }
    input {
      opacity: 0;
      outline: none;
      position: absolute;
      z-index: -1;

      // states styles for input
      &:checked ~ #{$this}__mark {
        @extend %radiobutton-mark--compact;
        border-color: colors.color('elvia-off');
      }

      &:focus ~ #{$this}__mark {
        @include outline.e-outline();
      }

      &:invalid ~ #{$this}__mark {
        border-color: colors.color('red');
      }

      &:disabled ~ #{$this}__mark {
        border-color: colors.color('disabled');
        background: colors.color('disabled-light');
        cursor: not-allowed;
      }
      &:disabled ~ #{$this}__label {
        color: colors.color('grey-70');
        cursor: not-allowed;
      }

      &:disabled:checked ~ #{$this}__mark {
        border-color: colors.color('disabled');
        background: colors.color('disabled-light');
        cursor: not-allowed;

        &:before,
        &:after {
          background-color: colors.color('grey-40');
        }
      }
      &:disabled:checked ~ #{$this}__label {
        color: colors.color('grey-70');
        cursor: not-allowed;
      }
    }

    .e-radio__mark {
      width: $form-radiobutton-compact-mark-size;
      height: $form-radiobutton-compact-mark-size;
    }
  }

  &:hover &__mark {
    background: colors.color('elvia-charge');
  }

  // Hide defualt radiostyle and put in placeholder style
  input {
    opacity: 0;
    outline: none;
    position: absolute;
    z-index: -1;

    // states styles for input
    &:checked ~ #{$this}__mark {
      @extend %radiobutton-mark;
      border-color: colors.color('elvia-off');
    }

    &:focus ~ #{$this}__mark {
      @include outline.e-outline();
    }

    &:invalid ~ #{$this}__mark {
      border-color: colors.color('red');
    }

    &:disabled ~ #{$this}__mark {
      border-color: colors.color('disabled');
      background: colors.color('disabled-light');
      cursor: not-allowed;
    }
    &:disabled ~ #{$this}__label {
      color: colors.color('grey-70');
      cursor: not-allowed;
    }

    &:disabled:checked ~ #{$this}__mark {
      border-color: colors.color('disabled');
      background: colors.color('disabled-light');
      cursor: not-allowed;

      &:before,
      &:after {
        background-color: colors.color('grey-40');
      }
    }
    &:disabled:checked ~ #{$this}__label {
      color: colors.color('grey-70');
      cursor: not-allowed;
    }
  }
  // Creating placeholder to inject style into radiobutton mutations.
  %radiobutton-mark {
    background-color: colors.color('elvia-charge');
    display: flex;
    align-items: center;
    justify-content: center;
    &:before {
      content: '';
      height: 12px;
      width: 12px;
      background-color: colors.color('elvia-off');
      border-radius: 50%;
      opacity: 1;
      @include helpers.animation(fadeIn, 250ms, linear, both);
    }
  }

  %radiobutton-mark--compact {
    background-color: colors.color('elvia-charge');
    display: flex;
    align-items: center;
    justify-content: center;
    &:before {
      content: '';
      height: 8px;
      width: 8px;
      background-color: colors.color('elvia-off');
      border-radius: 50%;
      opacity: 1;
      @include helpers.animation(fadeIn, 250ms, linear, both);
    }
  }

  @include helpers.keyframes(fadeIn) {
    0% {
      opacity: 0;
    }
    100% {
      opacity: 1;
    }
  }

  &__mark {
    display: inline-block;
    width: $form-radiobutton-mark-size;
    height: $form-radiobutton-mark-size;
    border: $form-radiobutton-mark-border;
    border-radius: $form-radiobutton-mark-border-radius;
    background: colors.color('elvia-on');
  }

  // pseudoclasses

  &.e-radio---checked {
    .e-radio__mark {
      @extend %radiobutton-mark;
    }
  }
  // extends correct radiomark for compact radiobuttons
  &.e-radio--compact[class$='e-radio---checked'] &__mark,
  &.e-radio--sm[class$='e-radio---checked'] &__mark {
    @extend %radiobutton-mark--compact;
  }

  &.e-radio---disabled {
    .e-radio__mark {
      border-color: colors.color('disabled');
      background: colors.color('disabled-light');
      cursor: not-allowed;
    }
    .e-radio__label {
      color: colors.color('grey-70');
      cursor: not-allowed;
    }
  }

  &.e-radio---disabled-checked {
    .e-radio__mark {
      @extend %radiobutton-mark;
      border-color: colors.color('disabled') !important;
      background: colors.color('disabled-light') !important;
      cursor: not-allowed;

      &:before,
      &:after {
        background-color: colors.color('grey-40') !important;
      }
    }
    .e-radio__label {
      color: colors.color('grey-70');
      cursor: not-allowed;
    }
  }
  // extends correct radiomark for compact radiobuttons
  &.e-radio--compact[class$='e-radio---disabled-checked'] &__mark,
  &.e-radio--sm[class$='e-radio---disabled-checked'] &__mark {
    @extend %radiobutton-mark--compact;
  }

  &.e-radio---focus {
    .e-radio__mark {
      @include outline.e-outline-pseudoclass();
    }
  }

  &:active,
  &.e-radio---hover {
    .e-radio__mark {
      background: colors.color('elvia-charge');
    }
  }

  &.e-radio---invalid {
    .e-radio__mark {
      border-color: colors.color('red');
    }
  }

  &__mark {
    position: absolute;
    top: 0px;
  }

  &.e-radio--compact,
  &.e-radio--sm {
    .e-radio__mark {
      top: 3px;
    }
    .e-radio__label {
      margin-left: 24px;
    }
  }
  &__label {
    flex-grow: 1;
    margin-left: 32px;
  }
}
